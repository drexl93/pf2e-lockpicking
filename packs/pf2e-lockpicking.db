{"name":"Lockpicking","permission":{"default":0,"TKPF0VhpkrvAyBOK":3},"type":"script","flags":{"furnace":{"runAsGM":false}},"scope":"global","command":"// Macro for the GM to run to set the DC and number of successes for the lock\r\n// Can pick from the set of published locks or create a custom one\r\n\r\nif (!token) {\r\n  ui.notifications.error(\"Please select a token.\")\r\n  return;\r\n}\r\n\r\nlet locks = {\r\n  poor: {DC: 15, successes: 2},\r\n  simple: {DC: 20, successes: 3},\r\n  average: {DC: 25, successes: 4},\r\n  good: {DC: 30, successes: 5},\r\n  superior: {DC: 40, successes: 6}\r\n}\r\n\r\nlet content = \"\";\r\nlet content2 = \"\";\r\n\r\ncontent += `<p><label for=\"preset\">Pick a preset: </label>\r\n<select name=\"preset\" id=\"preset\">\r\n  <option value=\"custom\">Custom</option>\r\n  <option value=\"poor\">Poor</option>\r\n  <option value=\"simple\">Simple</option>\r\n  <option value=\"average\">Average</option>\r\n  <option value=\"good\">Good</option>\r\n  <option value=\"superior\">Superior</option>\r\n</select>`\r\n\r\ncontent2 += `<form id=\"pf2e-lockpicking-gm_lockset-content2\"><p><label for=\"customDC\">DC: </label>\r\n<input type=\"text\" id=\"customDC\" name=\"customDC\"></p>\r\n\r\n<p><label for=\"successes\">Required Successes: </label>\r\n<input type=\"text\" id=\"successes\" name=\"successes\"></p></form>`\r\n\r\nlet dialog = new Dialog({\r\n  title: \"Lockpicking\",\r\n  content: content,\r\n  buttons: {\r\n    pick: {\r\n      icon: \"<i class='fas fa-check'></i>\",\r\n      label: \"Select\",\r\n      callback: (html) => {\r\n          let lock = (html.find('#preset')[0].value)\r\n          if (lock === \"custom\") {\r\n              customLock.options.width = 125\r\n              customLock.position.width = 125\r\n              customLock.render(true);\r\n          } else {\r\n              game.socket.emit('module.pf2e-lockpicking', {\r\n                  operation: 'playerLockpick',\r\n                  actor,\r\n                  neededSuccesses: locks[lock].successes,\r\n                  DC: locks[lock].DC \r\n              });\r\n          }\r\n      }\r\n    },\r\n  }\r\n})\r\ndialog.options.width = 125\r\ndialog.position.width = 125\r\ndialog.render(true);\r\n\r\nlet customLock = new Dialog({\r\n  title: \"Custom Lock\",\r\n  content: content2,\r\n  buttons: {\r\n    select: {\r\n      icon: \"<i class='fas fa-check'></i>\",\r\n      label: \"Select\",\r\n      callback: (html) => {\r\n          let neededSuccesses = parseInt(html.find('#successes')[0].value)\r\n          let DC = parseInt(html.find('#customDC')[0].value)\r\n          game.socket.emit('module.pf2e-lockpicking', {\r\n              operation: 'playerLockpick',\r\n              actor,\r\n              neededSuccesses,\r\n              DC\r\n          });\r\n      }\r\n    },\r\n  }\r\n})","author":"TKPF0VhpkrvAyBOK","img":"icons/svg/padlock.svg","actorIds":[],"_id":"7pjDywKX5ZOd0QeK"}
